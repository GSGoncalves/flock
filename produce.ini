[tweets/share/%{name}.txt]
dep.select = tweets/select/%{name}.gz
recipe = gzcat %{select} | bin/poultry show -t {t.id} > %{target}

[tweets/hydrate/%{name}.gz]
dep.share = tweets/share/%{name}.txt
recipe =
    bin/twarc.py \
    -c parts/etc/poultry.cfg \
    -p twitter \
    --hydrate %{share} | gzip > %{target}

[tweets/db/%{name}.inserted]
dep.hydrate = tweets/hydrate/%{name}.gz
dep.clusters = clusters.cfg
recipe =
    gzcat %{hydrate} \
    |\
    bin/flock insert \
    --clusters clusters.cfg \
    && touch %{target}
