[tweets/share/%{name}.txt]
dep.select = tweets/select/%{name}.gz
recipe = gzcat %{select} | bin/poultry show -t {t.id} > %{target}

[tweets/hydrate/%{name}.gz]
dep.share = tweets/share/%{name}.txt
recipe = bin/twarc.py  --hydrate %{share} | gzip > %{target}

[tweets/filter/%{filter_}/%{name}.gz]
dep.hydrate = tweets/hydrate/%{name}.gz
recipe =
    gzcat %{hydrate} \
    |\
    bin/poultry filter \
    --mode w \
    -c %{'poultry.cfg' if filter_ in ('riga', 'media', 'users') else 'second-stage.cfg'} \
    --filters filter:%{filter_} \
    |\
    gzip > %{target}
