[circus]
statsd = True

[watcher:selector]
cmd = ${parts.buildout['bin-directory']}/poultry
autostart = false
args =
    select
    --config ${options['poultry_cfg']}
    --source twitter://filter
    -o ${parts.buildout['parts-directory']}/pipe/pipe
    --verbose

[watcher:selector-qm]
cmd = ${parts.buildout['bin-directory']}/poultry
autostart = false
args =
    filter
    --config ${options['poultry_cfg_qm']}
    --source twitter://filter
    --verbose

[watcher:grouper]
cmd = ${parts.buildout['bin-directory']}/poultry
autostart = false
args =
    group
    --config ${options['poultry_cfg']}
    --source ${parts.buildout['parts-directory']}/pipe
    --file-name-template ${parts.buildout['directory']}/tweets/select/lv/%%Y-%%m-%%d-%%H.gz
priority = 20

[watcher:pg]
cmd = /opt/local/lib/postgresql96/bin/postgres
args = -D parts/postgres/data
autostart = false

[watcher:flock-web]
cmd = bin/chaussette --fd $(circus.sockets.web) flock_web.wsgi:app
autostart = false

numprocesses = 10
use_sockets = True

[env:flock-web]
FLOCK_CONFIG = ${parts['flock-web_config']['output']}

[socket:web]
host = 127.0.0.1
port = 5001

[watcher:redis]
cmd = ${parts['redis']['location']}/src/redis-server
autostart = false

[watcher:celery]
cmd = ${parts.buildout['bin-directory']}/celery worker -A flock_web.tasks
autostart = false

[env:celery]
FLOCK_CONFIG = ${parts['flock-web_config']['output']}

[watcher:flower]
cmd = ${parts.buildout['bin-directory']}/flower -A flock_web.tasks --port=4999
autostart = false

[env:flower]
FLOCK_CONFIG = ${parts['flock-web_config']['output']}
